<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.26">
    <link rel="shortcut icon" href="logo-favicon.png"><meta name="theme-color" content="#D7A318"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><title>Introduction | beeorm-redisearch-plugin</title><meta name="description" content="Plugin for BeeORM which enables integration with Redisearch">
    <link rel="preload" href="/beeorm-redisearch-plugin/assets/js/runtime~app.8365c559.js" as="script"><link rel="preload" href="/beeorm-redisearch-plugin/assets/css/styles.1dd1bd34.css" as="style"><link rel="preload" href="/beeorm-redisearch-plugin/assets/js/567.ce99827e.js" as="script"><link rel="preload" href="/beeorm-redisearch-plugin/assets/js/app.40f3d3bb.js" as="script">
    <link rel="stylesheet" href="/beeorm-redisearch-plugin/assets/css/styles.1dd1bd34.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a aria-current="page" href="/beeorm-redisearch-plugin/" class="router-link-active router-link-exact-active"><img class="logo" src="/beeorm-redisearch-plugin/logo-favicon-90x90.png" alt="beeorm-redisearch-plugin"><span class="site-name can-hide">beeorm-redisearch-plugin</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a aria-current="page" href="/beeorm-redisearch-plugin/" class="router-link-active router-link-exact-active nav-link" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/coretrix/beeorm-redisearch-plugin" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search..." autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a aria-current="page" href="/beeorm-redisearch-plugin/" class="router-link-active router-link-exact-active nav-link" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/coretrix/beeorm-redisearch-plugin" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">Guide</p><ul class=""><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/" class="router-link-active router-link-exact-active nav-link sidebar-item active" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#what-is-redisearch" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="What is Redisearch?"><!--[--><!--]--> What is Redisearch? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#how-it-works" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="How it works?"><!--[--><!--]--> How it works? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#installation" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#configuration" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#entities" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Entities"><!--[--><!--]--> Entities <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#filtering" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Filtering"><!--[--><!--]--> Filtering <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#custom-indexes" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Custom indexes"><!--[--><!--]--> Custom indexes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#custom-index-definition-example" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Custom index definition example"><!--[--><!--]--> Custom index definition example <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#statistics" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Statistics"><!--[--><!--]--> Statistics <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/beeorm-redisearch-plugin/#logging" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Logging"><!--[--><!--]--> Logging <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h1><p><code>beeorm-redisearch-plugin</code> is a plugin for <a href="https://beeorm.io/guide/" target="_blank" rel="noopener noreferrer">BeeORM<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> which enables integration with Redisearch.</p><h2 id="what-is-redisearch" tabindex="-1"><a class="header-anchor" href="#what-is-redisearch" aria-hidden="true">#</a> What is Redisearch?</h2><p>Redisearch is a source-available Redis module that enables querying, secondary indexing, and full-text search for Redis. These features enable multi-field queries, aggregation, exact phrase matching, numeric filtering, geo filtering and vector similarity semantic search on top of text queries.</p><h2 id="how-it-works" tabindex="-1"><a class="header-anchor" href="#how-it-works" aria-hidden="true">#</a> How it works?</h2><p>Instead of making complex queries to MySQL, you can query the much faster Redisearch, which will return the entity ID and ORM will load the entity from Redis cache by this ID. If the entity is not yet cached in Redis, the ORM will hit MySQL and then cache it.</p><h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>go get -u github.com/coretrix/beeorm-redisearch-plugin
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration" aria-hidden="true">#</a> Configuration</h2><ol><li><p>You need to use <a href="https://beeorm.io/guide/" target="_blank" rel="noopener noreferrer">BeeORM<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> in order to use this plugin.</p></li><li><p>Read how BeeORM plugins work and are set up <a href="https://beeorm.io/plugins/" target="_blank" rel="noopener noreferrer">BeeORM Plugins<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p></li><li><p>You can configure the connection with orm yaml file or with Go code, the following example shows configuration with code.</p></li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    beeormRegistry <span class="token operator">:=</span> beeorm<span class="token punctuation">.</span><span class="token function">NewRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// new BeeORM registry</span>
    
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterMySQLPool</span><span class="token punctuation">(</span><span class="token string">&quot;root:root@tcp(localhost:13306)/redisearch?multiStatements=true&quot;</span><span class="token punctuation">,</span> beeorm<span class="token punctuation">.</span>MySQLPoolOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span> <span class="token comment">// mysql connection</span>
    
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterRedis</span><span class="token punctuation">(</span><span class="token string">&quot;localhost:16379&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">)</span> <span class="token comment">// pool needed for redis cache</span>
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterRedis</span><span class="token punctuation">(</span><span class="token string">&quot;localhost:16379&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;streams_pool&quot;</span><span class="token punctuation">)</span> <span class="token comment">// pool needed for redis streams, which are used for force reindex and indexing custom indexes</span>
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterRedis</span><span class="token punctuation">(</span><span class="token string">&quot;localhost:16379&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;search_pool&quot;</span><span class="token punctuation">)</span> <span class="token comment">// pool needed for redisearch itself, its important that it uses db 0!</span>
    
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterEntity</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>entity<span class="token punctuation">.</span>TestEntityOne<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// redisearch enabled entities, see entities section</span>
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterEntity</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>entity<span class="token punctuation">.</span>TestEntityTwo<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    rsPlugin <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token string">&quot;search_pool&quot;</span><span class="token punctuation">)</span> <span class="token comment">// create plugin instance</span>
    rsPlugin<span class="token punctuation">.</span><span class="token function">RegisterCustomIndex</span><span class="token punctuation">(</span>customindex<span class="token punctuation">.</span><span class="token function">GetEntityOneIndex</span><span class="token punctuation">(</span><span class="token string">&quot;search_pool&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// register custom indexes here, see custom indexes section</span>
    
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterPlugin</span><span class="token punctuation">(</span>rsPlugin<span class="token punctuation">)</span> <span class="token comment">// register redisearch plugin in BeeORM</span>
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterPlugin</span><span class="token punctuation">(</span>fake_delete<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// register fake delete plugin in BeeORM (Redisearch plugin supports FakeDelete fields)</span>

    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterRedisStream</span><span class="token punctuation">(</span>redisearch<span class="token punctuation">.</span>RedisSearchIndexerChannel<span class="token punctuation">,</span> <span class="token string">&quot;streams_pool&quot;</span><span class="token punctuation">)</span> <span class="token comment">// register the default redis stream that is needed for reindex of the indexes</span>
    beeormRegistry<span class="token punctuation">.</span><span class="token function">RegisterRedisStreamConsumerGroups</span><span class="token punctuation">(</span>redisearch<span class="token punctuation">.</span>RedisSearchIndexerChannel<span class="token punctuation">,</span> redisearch<span class="token punctuation">.</span>RedisSearchIndexerChannel<span class="token operator">+</span><span class="token string">&quot;_group&quot;</span><span class="token punctuation">)</span>
	
    validatedRegistry<span class="token punctuation">,</span> err <span class="token operator">:=</span> beeormRegistry<span class="token punctuation">.</span><span class="token function">Validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// validate the BeeORM registry</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    beeormEngine <span class="token operator">=</span> validatedRegistry<span class="token punctuation">.</span><span class="token function">CreateEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// create BeeORM engine instance</span>
    
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> alter <span class="token operator">:=</span> <span class="token keyword">range</span> beeormEngine<span class="token punctuation">.</span><span class="token function">GetAlters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// execute DB alters</span>
        alter<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>beeormEngine<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    redisSearch <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">NewRedisSearch</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> beeormEngine<span class="token punctuation">,</span> <span class="token string">&quot;search_pool&quot;</span><span class="token punctuation">)</span> <span class="token comment">// create redisearch instance, use this instance to access all redisearch methods</span>
    
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> alter <span class="token operator">:=</span> <span class="token keyword">range</span> redisSearch<span class="token punctuation">.</span><span class="token function">GetRedisSearchAlters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// execute redisearch alters</span>
        alter<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="entities" tabindex="-1"><a class="header-anchor" href="#entities" aria-hidden="true">#</a> Entities</h2><p>In order to enable entities to be used in redisearch, you need to add the following tags:</p><ul><li><code>redisSearch=search_pool</code> in beeorm.ORM field, it must correspond with your redisearch pool name</li><li><code>searchable</code> in each field that you would like to filter by later</li><li><code>sortable</code> in each filed that you would like to be able to sort by later</li></ul><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    <span class="token keyword">type</span> TestEntityOne <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        beeorm<span class="token punctuation">.</span>ORM    <span class="token string">`orm:&quot;table=test_entity_one;redisCache;redisSearch=search_pool&quot;`</span>
        ID            <span class="token builtin">uint64</span>           <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        UintPtr       <span class="token operator">*</span><span class="token builtin">uint64</span>          <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        Int           <span class="token builtin">int64</span>            <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        IntPtr        <span class="token operator">*</span><span class="token builtin">int64</span>           <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        Float         <span class="token builtin">float64</span>          <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        FloatPtr      <span class="token operator">*</span><span class="token builtin">float64</span>         <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        String        <span class="token builtin">string</span>           <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        StringPtr     <span class="token operator">*</span><span class="token builtin">string</span>          <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        StringEnum    <span class="token builtin">string</span>           <span class="token string">`orm:&quot;searchable;sortable;enum=entity.TestEntityEnumAll&quot;`</span>
        StringEnumPtr <span class="token operator">*</span><span class="token builtin">string</span>          <span class="token string">`orm:&quot;searchable;sortable;enum=entity.TestEntityEnumAll&quot;`</span>
        StringSlice   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>         <span class="token string">`orm:&quot;searchable&quot;`</span>
        Bool          <span class="token builtin">bool</span>             <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        BoolPtr       <span class="token operator">*</span><span class="token builtin">bool</span>            <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        Time          time<span class="token punctuation">.</span>Time        <span class="token string">`orm:&quot;searchable;sortable;time=true&quot;`</span>
        TimePtr       <span class="token operator">*</span>time<span class="token punctuation">.</span>Time       <span class="token string">`orm:&quot;searchable;sortable;time=true&quot;`</span>
        ForeignKey    <span class="token operator">*</span>TestEntityTwo   <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
        Many          <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>TestEntityTwo <span class="token string">`orm:&quot;searchable&quot;`</span>
        FakeDelete    <span class="token builtin">bool</span>             <span class="token string">`orm:&quot;searchable&quot;`</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">type</span> TestEntityTwo <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        beeorm<span class="token punctuation">.</span>ORM <span class="token string">`orm:&quot;table=test_entity_two;redisCache;redisSearch=search_pool&quot;`</span>
        ID         <span class="token builtin">uint64</span>
        Field      <span class="token builtin">string</span> <span class="token string">`orm:&quot;searchable;sortable&quot;`</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="filtering" tabindex="-1"><a class="header-anchor" href="#filtering" aria-hidden="true">#</a> Filtering</h2><p>I will show a few filtering examples. Please check <code>query.go</code> for all filtering methods.</p><h4 id="redissearchone" tabindex="-1"><a class="header-anchor" href="#redissearchone" aria-hidden="true">#</a> RedisSearchOne</h4><p>You must use <code>RedisSearchOne</code> only when you are sure the filters you provide will result in a unique row.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>	q <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">NewRedisSearchQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	q<span class="token punctuation">.</span><span class="token function">FilterString</span><span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span>
    q<span class="token punctuation">.</span><span class="token function">FilterUint</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
	
	result <span class="token operator">:=</span> <span class="token operator">&amp;</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span>
	redisSearch<span class="token punctuation">.</span><span class="token function">RedisSearchOne</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token string">&quot;Address&quot;</span><span class="token punctuation">)</span> <span class="token comment">// loads the user inside the entity instance and loads its Address field reference</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="redissearchmany" tabindex="-1"><a class="header-anchor" href="#redissearchmany" aria-hidden="true">#</a> RedisSearchMany</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>	q <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">NewRedisSearchQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	q<span class="token punctuation">.</span><span class="token function">FilterString</span><span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Mark&quot;</span><span class="token punctuation">)</span> <span class="token comment">// you can provide multiple params as var args</span>
    q<span class="token punctuation">.</span><span class="token function">FilterUint</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
    q<span class="token punctuation">.</span><span class="token function">FilterDateTimeMinMax</span><span class="token punctuation">(</span>
        <span class="token string">&quot;CreatedAt&quot;</span><span class="token punctuation">,</span>
        time<span class="token punctuation">.</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>UTC<span class="token punctuation">)</span><span class="token punctuation">,</span>
        time<span class="token punctuation">.</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>UTC<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
	q<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// sorts the results by Age desc</span>
	
	results <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
	redisSearch<span class="token punctuation">.</span><span class="token function">RedisSearchMany</span><span class="token punctuation">(</span>results<span class="token punctuation">,</span> q<span class="token punctuation">,</span>  beeorm<span class="token punctuation">.</span><span class="token function">NewPager</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// loads the users inside the entity slice instance</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="raw-queries" tabindex="-1"><a class="header-anchor" href="#raw-queries" aria-hidden="true">#</a> Raw queries</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>	q <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">NewRedisSearchQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    q<span class="token punctuation">.</span><span class="token function">FilterInt</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    q<span class="token punctuation">.</span><span class="token function">AppendQueryRaw</span><span class="token punctuation">(</span><span class="token string">&quot;@Name: Fran*&quot;</span><span class="token punctuation">)</span> <span class="token comment">// in AppendQueryRaw you can put whatever query you want that satisfies the redisearch query language syntax</span>
    q<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span><span class="token string">&quot;Int&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    
    results <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>TestEntityOne<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    redisSearch<span class="token punctuation">.</span><span class="token function">RedisSearchMany</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>results<span class="token punctuation">,</span> q<span class="token punctuation">,</span> beeorm<span class="token punctuation">.</span><span class="token function">NewPager</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="aggregations" tabindex="-1"><a class="header-anchor" href="#aggregations" aria-hidden="true">#</a> Aggregations</h4><p>This plugin supports many aggregations, please see <code>aggregate.go</code> for all aggregation functions. The example below shows the <code>GroupByField</code> aggregation with reducer <code>NewAggregateReduceSum</code>.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>	q <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">NewRedisSearchQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	q<span class="token punctuation">.</span><span class="token function">FilterUint</span><span class="token punctuation">(</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>

	a <span class="token operator">:=</span> q<span class="token punctuation">.</span><span class="token function">Aggregate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	a<span class="token punctuation">.</span><span class="token function">GroupByField</span><span class="token punctuation">(</span><span class="token string">&quot;@Age&quot;</span><span class="token punctuation">,</span> redisearch<span class="token punctuation">.</span><span class="token function">NewAggregateReduceSum</span><span class="token punctuation">(</span><span class="token string">&quot;@WalletBalance&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;total_amount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	a<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span>redisearch<span class="token punctuation">.</span>RedisSearchAggregationSort<span class="token punctuation">{</span>
		Field<span class="token punctuation">:</span> <span class="token string">&quot;@total_amount&quot;</span><span class="token punctuation">,</span>
		Desc<span class="token punctuation">:</span>  <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	result<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> redisSearch<span class="token punctuation">.</span><span class="token function">RedisSearchAggregate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>entity<span class="token punctuation">.</span>TestEntityOne<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> beeorm<span class="token punctuation">.</span><span class="token function">NewPager</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> result <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token punctuation">{</span>
            <span class="token keyword">continue</span>
        <span class="token punctuation">}</span>
        
        age<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseUint</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&quot;Age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        amount<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseFloat</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&quot;total_amount&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="custom-indexes" tabindex="-1"><a class="header-anchor" href="#custom-indexes" aria-hidden="true">#</a> Custom indexes</h2><p>Sometimes you may need to join MySQL tables in order to execute some complex query. Instead of doing this, you can simply create a custom index, which can contain fields from 1,2,3...100 tables. In order to create custom index, first you must create a CRUD stream on the main entity the index will track. This CRUD stream will be used for indexing. <a href="https://beeorm.io/plugins/crud_stream.html" target="_blank" rel="noopener noreferrer">see BeeORM CRUD streams<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="custom-index-definition-example" tabindex="-1"><a class="header-anchor" href="#custom-index-definition-example" aria-hidden="true">#</a> Custom index definition example</h2><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    <span class="token keyword">const</span> UsersAddressesCustomIndex <span class="token operator">=</span> <span class="token string">&quot;custom_index_users_addresses&quot;</span> <span class="token comment">// custom index name</span>

    <span class="token keyword">func</span> <span class="token function">GetUsersAddressesIndex</span><span class="token punctuation">(</span>redisSearchPool <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">*</span>redisearch<span class="token punctuation">.</span>RedisSearchIndex <span class="token punctuation">{</span> <span class="token comment">// register this function in the plugin definition</span>
        index <span class="token operator">:=</span> <span class="token operator">&amp;</span>redisearch<span class="token punctuation">.</span>RedisSearchIndex<span class="token punctuation">{</span><span class="token punctuation">}</span>
        index<span class="token punctuation">.</span>Name <span class="token operator">=</span> UsersAddressesCustomIndex
        index<span class="token punctuation">.</span>RedisPool <span class="token operator">=</span> redisSearchPool
        index<span class="token punctuation">.</span>Prefixes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>UsersAddressesCustomIndex <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">}</span>
        
        <span class="token comment">// document fields</span>
        index<span class="token punctuation">.</span><span class="token function">AddNumericField</span><span class="token punctuation">(</span><span class="token string">&quot;ID&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        index<span class="token punctuation">.</span><span class="token function">AddTextField</span><span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        index<span class="token punctuation">.</span><span class="token function">AddTextField</span><span class="token punctuation">(</span><span class="token string">&quot;AddressLine1&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        
        <span class="token comment">// force reindex callback func, it will be called by the plugin each time you force reindex</span>
        index<span class="token punctuation">.</span>Indexer <span class="token operator">=</span> usersAddressesIndexer
        
        <span class="token keyword">return</span> index
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function">SetUsersAddressesIndexFields</span><span class="token punctuation">(</span>pusher redisearch<span class="token punctuation">.</span>RedisSearchIndexPusher<span class="token punctuation">,</span> entities <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>UserEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// call this function in your CRUD stream consumer from UserEntity</span>
        deletedIDs <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> entityIter <span class="token operator">:=</span> <span class="token keyword">range</span> entities <span class="token punctuation">{</span>
            id <span class="token operator">:=</span> UsersAddressesCustomIndex <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> strconv<span class="token punctuation">.</span><span class="token function">FormatUint</span><span class="token punctuation">(</span>entityIter<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> entityIter<span class="token punctuation">.</span>FakeDelete <span class="token punctuation">{</span>
                deletedIDs <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>deletedIDs<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
                
                <span class="token keyword">continue</span>
            <span class="token punctuation">}</span>
        
            pusher<span class="token punctuation">.</span><span class="token function">NewDocument</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            pusher<span class="token punctuation">.</span><span class="token function">SetUint</span><span class="token punctuation">(</span><span class="token string">&quot;ID&quot;</span><span class="token punctuation">,</span> entityIter<span class="token punctuation">.</span>ID<span class="token punctuation">)</span>
            pusher<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">,</span> entityIter<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
            pusher<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">&quot;AddressLine1&quot;</span><span class="token punctuation">,</span> entityIter<span class="token punctuation">.</span>Address<span class="token punctuation">.</span>AddressLine1<span class="token punctuation">)</span> <span class="token comment">// make sure you load the Address reference</span>
            pusher<span class="token punctuation">.</span><span class="token function">PushDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>deletedIDs<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            pusher<span class="token punctuation">.</span><span class="token function">DeleteDocuments</span><span class="token punctuation">(</span>deletedIDs<span class="token operator">...</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">func</span> <span class="token function">usersAddressesIndexer</span><span class="token punctuation">(</span>engine beeorm<span class="token punctuation">.</span>Engine<span class="token punctuation">,</span> lastID <span class="token builtin">uint64</span><span class="token punctuation">,</span> pusher redisearch<span class="token punctuation">.</span>RedisSearchIndexPusher<span class="token punctuation">)</span> <span class="token punctuation">(</span>newID <span class="token builtin">uint64</span><span class="token punctuation">,</span> hasMore <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        where <span class="token operator">:=</span> beeorm<span class="token punctuation">.</span><span class="token function">NewWhere</span><span class="token punctuation">(</span><span class="token string">&quot;`ID` &gt; ? AND `FakeDelete` &gt;= 0 ORDER BY `ID` ASC&quot;</span><span class="token punctuation">,</span> lastID<span class="token punctuation">)</span>
        
        entities <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>UserEntity<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        engine<span class="token punctuation">.</span><span class="token function">Search</span><span class="token punctuation">(</span>where<span class="token punctuation">,</span> beeorm<span class="token punctuation">.</span><span class="token function">NewPager</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>entities<span class="token punctuation">,</span> <span class="token string">&quot;Address&quot;</span><span class="token punctuation">)</span> <span class="token comment">// load the Address reference, because we use it in the custom index</span>
        
        <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>entities<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> lastID<span class="token punctuation">,</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        
        <span class="token function">SetUsersAddressesIndexFields</span><span class="token punctuation">(</span>pusher<span class="token punctuation">,</span> entities<span class="token punctuation">)</span>
        pusher<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        lastID <span class="token operator">=</span> entities<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>entities<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ID
        
        <span class="token keyword">return</span> lastID<span class="token punctuation">,</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>entities<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>After you make the custom index definition, you need to register it in the plugin:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    rsPlugin<span class="token punctuation">.</span><span class="token function">RegisterCustomIndex</span><span class="token punctuation">(</span>customindex<span class="token punctuation">.</span><span class="token function">GetUsersAddressesIndex</span><span class="token punctuation">(</span><span class="token string">&quot;search_pool&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h4 id="custom-index-query" tabindex="-1"><a class="header-anchor" href="#custom-index-query" aria-hidden="true">#</a> Custom index query</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>	q <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">NewRedisSearchQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	q<span class="token punctuation">.</span><span class="token function">FilterString</span><span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span>

	ids<span class="token punctuation">,</span> total <span class="token operator">:=</span> redisearch<span class="token punctuation">.</span><span class="token function">GetEntityIDs</span><span class="token punctuation">(</span>redisSearch<span class="token punctuation">,</span> customindex<span class="token punctuation">.</span>EntityOneCustomIndex<span class="token punctuation">,</span> q<span class="token punctuation">,</span> beeorm<span class="token punctuation">.</span><span class="token function">NewPager</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

	result <span class="token operator">:=</span> <span class="token operator">&amp;</span>entity<span class="token punctuation">.</span>TestEntityOne<span class="token punctuation">{</span><span class="token punctuation">}</span>
	engine<span class="token punctuation">.</span><span class="token function">LoadByID</span><span class="token punctuation">(</span>ids<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="statistics" tabindex="-1"><a class="header-anchor" href="#statistics" aria-hidden="true">#</a> Statistics</h2><p>Use <code>redisSearch.GetRedisSearchStatistics()</code> for many useful stats.</p><h2 id="logging" tabindex="-1"><a class="header-anchor" href="#logging" aria-hidden="true">#</a> Logging</h2><p>Enable logging by <code>ormEngine.EnableQueryDebugCustom(false, true, false)</code>. It will output logs in the following format:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>FT.SEARCH entity.TestEntityOne @String:( &quot;test string 1&quot; )-@FakeDelete:{true} NOCONTENT LIMIT 0 1: [1 2287b:1]
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/coretrix/beeorm-redisearch-plugin/edit/main/docs/docs/README.md" rel="noopener noreferrer" target="_blank" aria-label><!--[--><!--]-->  <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">8/16/2023, 9:45:08 AM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: a.shumansky@gmail.com">Anton</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: krasimir.ivanov@coretrix.com">Krasimir Ivanov</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/beeorm-redisearch-plugin/assets/js/runtime~app.8365c559.js" defer></script><script src="/beeorm-redisearch-plugin/assets/js/567.ce99827e.js" defer></script><script src="/beeorm-redisearch-plugin/assets/js/app.40f3d3bb.js" defer></script>
  </body>
</html>
